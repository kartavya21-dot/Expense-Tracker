# Backend Vulnerability and Improvement Report

This document outlines the security vulnerabilities, coding mistakes, and suggestions for improvement for the Django backend of the Workout Tracker application.

## 1. Critical Security Vulnerabilities

These are high-priority issues that should be fixed immediately as they pose a significant security risk to the application and its data.

### 1.1. No Authentication or Authorization on API Endpoints
- **File:** `Backend/expense/tracker/views.py`
- **Vulnerability:** The `TrackerViewSet` does not have any permission classes defined (`permission_classes`). This means **anyone on the internet can create, view, update, and delete expenses**.
- **Impact:** Complete data exposure and unauthorized data manipulation.
- **Recommendation:**
    - Implement authentication, for example, using `djangorestframework-simplejwt` for token-based authentication.
    - Add `permission_classes = [IsAuthenticated]` to the `TrackerViewSet` to ensure only logged-in users can access it.

### 1.2. Debug Mode Enabled in Production
- **File:** `Backend/expense/expense/settings.py`
- **Vulnerability:** `DEBUG = True` is set. Running a Django application with debug mode enabled in production exposes sensitive information, such as configuration settings, local variables, and stack traces upon errors.
- **Impact:** Information leakage that can help an attacker gain deeper access to the system.
- **Recommendation:** Set `DEBUG = False` in a production environment. Use an environment variable to control this setting.

### 1.3. Hardcoded Secret Key
- **File:** `Backend/expense/expense/settings.py`
- **Vulnerability:** The `SECRET_KEY` is hardcoded directly in the settings file. This key is crucial for cryptographic signing (sessions, password reset tokens, etc.).
- **Impact:** If the source code is ever exposed, the compromised key could allow an attacker to forge signed messages, leading to remote code execution or privilege escalation.
- **Recommendation:** Load the `SECRET_KEY` from an environment variable. Never commit it to version control.

### 1.4. Insecure Cross-Origin Resource Sharing (CORS) Policy
- **File:** `Backend/expense/expense/settings.py`
- **Vulnerability:** `CORS_ALLOW_ALL_ORIGINS = True` allows any website to send requests to your backend.
- **Impact:** This makes your application vulnerable to Cross-Site Request Forgery (CSRF) and allows malicious websites to interact with your API, potentially stealing or manipulating user data.
- **Recommendation:** Change this setting to `CORS_ALLOWED_ORIGINS` and provide a specific list of trusted domains (e.g., `['http://localhost:3000', 'https://your-frontend-domain.com']`).

## 2. Mistakes and Bad Practices

These are issues that deviate from best practices and can lead to bugs, maintenance problems, or security risks.

### 2.1. Empty `ALLOWED_HOSTS`
- **File:** `Backend/expense/expense/settings.py`
- **Mistake:** The `ALLOWED_HOSTS` list is empty. While this works with `DEBUG=True`, the application will refuse to run once you switch to `DEBUG=False`.
- **Recommendation:** Populate this list with the domain names and IP addresses that are allowed to host your application (e.g., `['.your-domain.com', 'localhost']`).

### 2.2. No User Association for Data
- **Files:** `Backend/expense/tracker/models.py`, `Backend/expense/tracker/views.py`
- **Mistake:** The `Expense` model has no relation to a user. This means all expenses are stored in a single public pool. The application cannot distinguish between data from different users.
- **Recommendation:**
    - Add a `ForeignKey` to the `User` model in the `Expense` model: `user = models.ForeignKey(User, on_delete=models.CASCADE)`.
    - In the `TrackerViewSet`, filter the queryset to only return objects belonging to the currently authenticated user: `Expense.objects.filter(user=self.request.user)`.
    - Update the serializer to associate the new expense with the current user on creation.

### 2.3. Client-Controlled Timestamps
- **Files:** `Backend/expense/tracker/models.py`, `Backend/expense/tracker/serializers.py`
- **Mistake:** The `created_at` field in the `Expense` model is a simple `DateTimeField` and is not read-only in the serializer. This allows the client to set an arbitrary creation date.
- **Recommendation:**
    - In `models.py`, change the field to `created_at = models.DateTimeField(auto_now_add=True)`. This will automatically set the timestamp to the current time when an object is created.
    - Make the field read-only in the serializer to prevent clients from updating it: `read_only_fields = ['id', 'created_at']`.

### 2.4. No Unit Tests
- **File:** `Backend/expense/tracker/tests.py`
- **Mistake:** The test file is empty. Without tests, you cannot reliably verify that your code works as expected or safely refactor it in the future.
- **Recommendation:** Write unit and integration tests for your models, views, and serializers to ensure correctness and prevent regressions.

### 2.5. Silent Failure in View Logic
- **File:** `Backend/expense/tracker/views.py`
- **Mistake:** In the `get_queryset` method, if an invalid date format is provided in the `date` query parameter, the `ValueError` exception is caught and ignored (`pass`). The user receives a successful response with an unfiltered list, which is misleading.
- **Recommendation:** Raise a `serializers.ValidationError` or return a `Response` with a 400 status code and an error message explaining the expected date format (e.g., `{'error': 'Date format must be YYYY-MM-DD'}`).

## 3. Suggestions for Improvement

These are recommendations to improve the quality, scalability, and maintainability of your code.

### 3.1. Use a Production-Ready Database
- **File:** `Backend/expense/expense/settings.py`
- **Suggestion:** The project is configured to use SQLite. While excellent for development, it is not suitable for production use cases with concurrent requests.
- **Recommendation:** Plan to migrate to a more robust database like PostgreSQL or MySQL for production.

### 3.2. Use `DecimalField` for Prices
- **File:** `Backend/expense/tracker/models.py`
- **Suggestion:** The `price` field uses `IntegerField`. For monetary values, it is best practice to use `DecimalField` to avoid potential floating-point precision issues.
- **Recommendation:** Change the `price` field to `price = models.DecimalField(max_digits=10, decimal_places=2)`.

### 3.3. Obscure the Admin URL
- **File:** `Backend/expense/expense/urls.py`
- **Suggestion:** The admin interface is located at the default `/admin/` URL, which is a common target for automated attacks.
- **Recommendation:** Change the admin path to something less predictable (e.g., `path('my-secret-admin-panel/', admin.site.urls)`).
